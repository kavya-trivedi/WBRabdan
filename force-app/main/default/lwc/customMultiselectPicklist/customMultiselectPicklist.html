<template>
    <div class="multi-select-container">
        <div class="selected-values" onclick={toggleDropdown}>
            <span>{selectedCountText}</span>
            <lightning-icon icon-name="utility:down" alternative-text="Open dropdown" class="dropdown-icon"></lightning-icon>
        </div>

        <div class="dropdown" tabindex="0" onfocusout={handleBlur} if:true={isDropdownOpen}>
            <div class="searchbar">
                <input type="text" placeholder="Search..." value={searchTerm} oninput={handleSearchInput} class="search-input" />
                <lightning-icon icon-name="utility:search" alternative-text="search" class="dropdown-icon search"></lightning-icon>
            </div>
            <ul>
                <template for:each={filteredOptions} for:item="option">
                    <li key={option.value} class="dropdown-item">
                        <input type="checkbox" name={option.value} checked={option.selected} onchange={handleOptionChange} />
                        <label>{option.label}</label>
                    </li>
                </template>
            </ul>
        </div>
    </div>
</template>